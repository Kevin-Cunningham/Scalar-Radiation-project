(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    111215,       2811]
NotebookOptionsPosition[    108181,       2757]
NotebookOutlinePosition[    108613,       2774]
CellTagsIndexPosition[    108570,       2771]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"<<", "SpinWeightedSpheroidalHarmonics`"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "KerrGeodesics`"}]}], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"fa6c7144-3c9c-436e-9792-8bc2b212b88b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Integrator", " ", "using", " ", "the", " ", "trapezoidal", " ", 
    "method"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Take", " ", "10"}], ",", 
    RowBox[{"000", " ", "steps", " ", "by", " ", 
     RowBox[{"default", ".", " ", "Might"}], " ", "need", " ", "to", " ", 
     "change", " ", "this", " ", "in", " ", "future"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Trap", "[", 
     RowBox[{"Func_", ",", "x0_", ",", "xN_"}], 
     RowBox[{"(*", 
      RowBox[{",", "Ni_"}], "*)"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"f", "=", "Func"}], ",", 
        RowBox[{"a", "=", "x0"}], ",", 
        RowBox[{"b", "=", "xN"}], ",", "N1", 
        RowBox[{"(*", 
         RowBox[{"=", "Ni"}], "*)"}], ",", "\[CapitalDelta]x", ",", "Ans", 
        ",", "\[Lambda]"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"N1", "=", "10000"}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[CapitalDelta]x", " ", "=", " ", 
        FractionBox[
         RowBox[{"b", "-", "a"}], "N1"]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Ans", "=", " ", 
        RowBox[{
         FractionBox["\[CapitalDelta]x", "2"], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"f", "/.", 
             RowBox[{"{", 
              RowBox[{"\[Lambda]", "->", "a"}], "}"}]}], ")"}], "+", 
           RowBox[{"(", 
            RowBox[{"f", "/.", 
             RowBox[{"{", 
              RowBox[{"\[Lambda]", "->", "b"}], "}"}]}], ")"}], "+", 
           RowBox[{"2", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"f", "/.", 
                RowBox[{"{", 
                 RowBox[{"\[Lambda]", "->", 
                  RowBox[{"a", "+", 
                   RowBox[{"k", " ", "\[CapitalDelta]x"}]}]}], "}"}]}], ")"}],
               ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "1", ",", 
                RowBox[{"N1", "-", "1"}]}], "}"}]}], "]"}]}]}], ")"}]}]}]}]}],
      "]"}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.851761167486765*^9, 3.851761182016391*^9}, {
   3.851761222715171*^9, 3.8517612851222525`*^9}, {3.851761439851633*^9, 
   3.851761472351475*^9}, {3.8517615533854055`*^9, 3.8517615539750776`*^9}, {
   3.8517615964253845`*^9, 3.8517616094952517`*^9}, 3.851762401255166*^9},
 CellLabel->"In[3]:=",ExpressionUUID->"99355c76-e0e6-48e9-954f-40c0e8a73720"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dtd\[Lambda]", "[", 
    RowBox[{
    "M_", ",", "a_", ",", "r_", ",", "\[ScriptCapitalE]_", ",", 
     "\[ScriptCapitalL]_", ",", "\[Theta]_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"\[ScriptCapitalE]", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["r", "2"], "+", 
           SuperscriptBox["a", "2"]}], ")"}], "2"], 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["r", "2"], "-", 
          RowBox[{"2", " ", "M", " ", "r"}], "+", 
          SuperscriptBox["a", "2"]}], ")"}]], "-", 
       RowBox[{
        SuperscriptBox["a", "2"], 
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], ")"}]}], "+", 
    RowBox[{"a", " ", "\[ScriptCapitalL]", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["r", "2"], "+", 
         SuperscriptBox["a", "2"]}], 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["r", "2"], "-", 
          RowBox[{"2", "M", " ", "r"}], "+", 
          SuperscriptBox["a", "2"]}], ")"}]]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gtt", "[", 
    RowBox[{"M_", ",", "a_", ",", "r_", ",", "\[Theta]_"}], "]"}], " ", ":=", 
   " ", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["a", "4"], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["r", "4"]}], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", "r", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "M"}], "+", 
         RowBox[{"3", " ", "r"}]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["a", "2"], "+", 
         RowBox[{"r", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], 
       " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["a", "2"], "+", 
        RowBox[{"r", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["a", "2"], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["r", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["a", "2"], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], ")"}]}]]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gt\[Phi]", "[", 
    RowBox[{"M_", ",", "a_", ",", "r_", ",", "\[Theta]_"}], "]"}], ":=", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"4", " ", "a", " ", "M", " ", "r"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["a", "2"], "+", 
        RowBox[{"r", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["a", "2"], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["r", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["a", "2"], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], ")"}]}]]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ut", "[", 
    RowBox[{
    "M_", ",", "a_", ",", "r_", ",", "\[ScriptCapitalE]_", ",", 
     "\[ScriptCapitalL]_", ",", "\[Theta]_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"gt\[Phi]", "[", 
      RowBox[{"M", ",", "a", ",", "r", ",", "\[Theta]"}], "]"}], " ", 
     "\[ScriptCapitalL]"}], "-", " ", 
    RowBox[{
     RowBox[{"gtt", "[", 
      RowBox[{"M", ",", "a", ",", "r", ",", "\[Theta]"}], "]"}], " ", 
     "\[ScriptCapitalE]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.853819764933235*^9, 3.8538197663213024`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"bcd23571-9956-47cb-b202-9ee0ed9587d5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SourceNonZero", "[", 
   RowBox[{
   "l_", ",", "m_", ",", "k_", ",", "M_", ",", "a_", ",", "r0_", ",", "xi_"}],
    "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ly", "=", "l"}], ",", 
      RowBox[{"my", "=", "m"}], ",", 
      RowBox[{"ky", "=", "k"}], ",", 
      RowBox[{"My", "=", "M"}], ",", 
      RowBox[{"ay", "=", "a"}], ",", 
      RowBox[{"r0y", "=", "r0"}], ",", 
      RowBox[{"xiy", "=", "xi"}], ",", "\[CapitalDelta]", ",", 
      "\[ScriptCapitalE]", ",", "\[ScriptCapitalL]", ",", "\[ScriptCapitalQ]",
       ",", "\[CapitalOmega]\[Theta]", ",", "\[CapitalOmega]\[Phi]", ",", 
      "\[CapitalUpsilon]", ",", "\[Lambda]", ",", "Freqs", ",", "tp", ",", 
      "rp", ",", "\[Theta]p", ",", "\[Phi]p", ",", "orbit", ",", "Integrand", 
      ",", "Ans", ",", "S"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"orbit", " ", "=", " ", 
      RowBox[{"KerrGeoOrbit", "[", 
       RowBox[{"ay", ",", "r0y", ",", "0", ",", "xiy"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tp", ",", "rp", ",", "\[Theta]p", ",", "\[Phi]p"}], "}"}], 
      "=", 
      RowBox[{"orbit", "[", "\"\<Trajectory\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalDelta]", "=", 
      RowBox[{
       SuperscriptBox["r0y", "2"], "-", 
       RowBox[{"2", "My", " ", "r0y"}], " ", "+", " ", 
       SuperscriptBox["ay", "2"]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalE]", "=", 
      RowBox[{"orbit", "[", "\"\<Energy\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalL]", "=", 
      RowBox[{"orbit", "[", "\"\<AngularMomentum\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalUpsilon]", " ", "=", 
      RowBox[{
       RowBox[{"orbit", "[", "\"\<Frequencies\>\"", "]"}], "[", 
       "\"\<\!\(\*SubscriptBox[\(\[CapitalUpsilon]\), \(\[Theta]\)]\)\>\"", 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Freqs", " ", "=", " ", 
      RowBox[{"KerrGeoFrequencies", "[", 
       RowBox[{"ay", ",", "r0y", ",", "0", ",", "xiy"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalOmega]\[Theta]", " ", "=", " ", 
      RowBox[{"Freqs", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalOmega]\[Phi]", " ", "=", " ", 
      RowBox[{"Freqs", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"S", "=", 
      RowBox[{"SpinWeightedSpheroidalHarmonicS", "[", 
       RowBox[{"0", ",", "ly", ",", "my", ",", 
        RowBox[{"ay", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"m", " ", "\[CapitalOmega]\[Phi]"}], "+", 
           RowBox[{"k", " ", "\[CapitalOmega]\[Theta]"}]}], ")"}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Integrand", ":=", 
      RowBox[{
       FractionBox[
        RowBox[{"S", "[", 
         RowBox[{
          RowBox[{"\[Theta]p", "[", "\[Lambda]", "]"}], ",", "0"}], "]"}], 
        RowBox[{"ut", "[", 
         RowBox[{
         "My", ",", "ay", ",", "r0y", ",", "\[ScriptCapitalE]", ",", 
          "\[ScriptCapitalL]", ",", 
          RowBox[{"\[Theta]p", "[", "\[Lambda]", "]"}]}], "]"}]], 
       RowBox[{"Cos", "[", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"m", " ", "\[CapitalOmega]\[Phi]"}], "+", 
             RowBox[{"k", " ", "\[CapitalOmega]\[Theta]"}]}], ")"}], " ", 
           RowBox[{"tp", "[", "\[Lambda]", "]"}]}], "-", 
          RowBox[{"my", " ", 
           RowBox[{"\[Phi]p", "[", "\[Lambda]", "]"}]}]}], ")"}], "]"}], 
       RowBox[{"dtd\[Lambda]", "[", 
        RowBox[{
        "My", ",", "ay", ",", "r0y", ",", "\[ScriptCapitalE]", ",", 
         "\[ScriptCapitalL]", ",", 
         RowBox[{"\[Theta]p", "[", "\[Lambda]", "]"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Ans", "=", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{" ", 
          RowBox[{"8", "\[CapitalOmega]\[Theta]", " ", "r0y"}]}], 
         RowBox[{"\[CapitalDelta]", " "}]]}], " ", 
       RowBox[{"Quiet", "[", 
        RowBox[{"NIntegrate", "[", 
         RowBox[{"Integrand", ",", 
          RowBox[{"{", 
           RowBox[{"\[Lambda]", ",", "0", ",", 
            FractionBox["\[Pi]", 
             RowBox[{"2", "\[CapitalUpsilon]"}]]}], "}"}], ",", 
          RowBox[{"Method", "->", "\"\<Trapezoidal\>\""}], ",", 
          RowBox[{"PrecisionGoal", "\[Rule]", "30"}]}], 
         RowBox[{"(*", 
          RowBox[{",", 
           RowBox[{"MaxRecursion", "->", "30"}]}], "*)"}], "]"}], "]"}]}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "Ans"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.8517613105711684`*^9, 3.8517613342302337`*^9}, {
   3.851761395671381*^9, 3.8517614117415147`*^9}, {3.851761815525751*^9, 
   3.8517619375009584`*^9}, {3.851761981635355*^9, 3.851761984255659*^9}, {
   3.85176208078563*^9, 3.8517620893260746`*^9}, {3.8517629374984083`*^9, 
   3.8517629532213078`*^9}, {3.8517631173966103`*^9, 3.851763117686633*^9}, 
   3.8529784616303396`*^9, 3.852978639201168*^9, 3.852978850605994*^9, {
   3.852978909647025*^9, 3.8529789251771493`*^9}, {3.8538231613088627`*^9, 
   3.8538231640103903`*^9}, {3.8541881066413136`*^9, 3.854188113156021*^9}, {
   3.854188333195778*^9, 3.854188338926255*^9}, {3.8541887655217514`*^9, 
   3.854188807698019*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"373c5412-f293-445b-afa3-6e5082761baf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SourceNonZero", "[", 
  RowBox[{"3", ",", "2", ",", "3", ",", "1", ",", ".998", ",", "10", ",", 
   RowBox[{"Cos", "[", 
    RowBox[{"\[Pi]", "/", "6"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8541881347131157`*^9, 3.8541881735371046`*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"3c677efe-45bc-4945-bc89-c2cf7a727785"],

Cell[BoxData["0.0002743100189340485`"], "Output",
 CellChangeTimes->{{3.8541887414033384`*^9, 3.854188811239102*^9}, 
   3.855744589105819*^9, 3.8558159979295783`*^9, 3.855816285337914*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"eb4e9bdf-fe59-4005-98c6-2a7fff3d5ee7"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Source", "[", 
    RowBox[{
    "l_", ",", "m_", ",", "k_", ",", "M_", ",", "a_", ",", "r0_", ",", 
     "xi_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{"l", "+", "m", "+", "k"}], ",", "2"}], "]"}], "==", "1"}], 
     ",", "0", ",", 
     RowBox[{"SourceNonZero", "[", 
      RowBox[{
      "l", ",", "m", ",", "k", ",", "M", ",", "a", ",", "r0", ",", "xi"}], 
      "]"}]}], "]"}]}], ";"}]], "Input",
 CellLabel->"In[9]:=",ExpressionUUID->"1bbee7e6-50c9-4954-93b5-1c92ba244dac"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Init\[Psi]out", "[", 
   RowBox[{
   "l_", ",", "m_", ",", "kout_", ",", "a_", ",", "M_", ",", "\[Omega]i_"}], 
   "]"}], " ", ":=", " ", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"i", " ", "=", " ", "l"}], ",", " ", 
      RowBox[{"j", "=", " ", "m"}], " ", ",", " ", 
      RowBox[{"N", "=", "kout"}], ",", " ", 
      RowBox[{"s", " ", "=", " ", "a"}], ",", " ", 
      RowBox[{"\[CapitalMu]", "=", "M"}], ",", " ", "f0", ",", "f1", ",", 
      "f2", ",", "f3", ",", "f4", ",", "f5", ",", "f6", ",", "n", ",", 
      RowBox[{"\[Omega]", "=", "\[Omega]i"}], ",", "\[Lambda]"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Lambda]", " ", "=", 
      RowBox[{
       RowBox[{"SpinWeightedSpheroidalEigenvalue", "[", 
        RowBox[{"0", ",", "i", ",", "j", ",", 
         RowBox[{"s", " ", "\[Omega]"}]}], "]"}], "-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"s", " ", "\[Omega]"}], ")"}], "2"], "+", 
       RowBox[{"2", " ", "j", " ", "s", " ", "\[Omega]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"f0", "=", " ", 
      RowBox[{
       RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", "n", " ", 
       "\[Omega]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"f1", "=", 
      RowBox[{
       SuperscriptBox["n", "2"], "-", "\[Lambda]", "+", 
       RowBox[{"\[Omega]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "4"}], " ", "\[ImaginaryI]", " ", "\[CapitalMu]"}], 
          "+", 
          RowBox[{
           SuperscriptBox["s", "2"], " ", "\[Omega]"}]}], ")"}]}], "+", 
       RowBox[{"n", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{
          "4", " ", "\[ImaginaryI]", " ", "\[CapitalMu]", " ", "\[Omega]"}]}],
          ")"}]}]}]}], ";", "\n", 
     RowBox[{"f2", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
        SuperscriptBox["s", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "\[Omega]"}], "+", 
       RowBox[{"2", "\[CapitalMu]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "3"}], "+", 
          RowBox[{"5", " ", "n"}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["n", "2"]}], "+", "\[Lambda]", "-", 
          RowBox[{"2", " ", "s", " ", "j", " ", "\[Omega]"}], "+", 
          RowBox[{
           SuperscriptBox["s", "2"], " ", 
           SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}]}]}], ";", "\n", 
     RowBox[{"f3", "=", 
      RowBox[{
       RowBox[{"4", " ", 
        SuperscriptBox["\[CapitalMu]", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "n"}], ")"}], "2"]}], "+", 
       RowBox[{
        SuperscriptBox["s", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"8", "+", 
          SuperscriptBox["j", "2"], "-", 
          RowBox[{"8", " ", "n"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["n", "2"]}], "-", "\[Lambda]"}], ")"}]}]}]}], ";", 
     "\n", 
     RowBox[{"f4", "=", 
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       SuperscriptBox["a", "2"], " ", "\[CapitalMu]", " ", 
       RowBox[{"(", 
        RowBox[{"15", "-", 
         RowBox[{"11", " ", "n"}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["n", "2"]}]}], ")"}]}]}], ";", "\n", 
     RowBox[{"f5", "=", 
      RowBox[{
       SuperscriptBox["s", "4"], " ", 
       RowBox[{"(", 
        RowBox[{"12", "-", 
         RowBox[{"7", " ", "n"}], "+", 
         SuperscriptBox["n", "2"]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"cs", " ", "=", " ", 
      RowBox[{"RecurrenceTable", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"f0", " ", 
             RowBox[{"c", "[", "n", "]"}]}], "+", 
            RowBox[{"f1", " ", 
             RowBox[{"c", "[", 
              RowBox[{"n", "-", "1"}], "]"}]}], "+", 
            RowBox[{"f2", " ", 
             RowBox[{"c", "[", 
              RowBox[{"n", "-", "2"}], "]"}]}], "+", 
            RowBox[{"f3", " ", 
             RowBox[{"c", "[", 
              RowBox[{"n", "-", "3"}], "]"}]}], "+", 
            RowBox[{"f4", " ", 
             RowBox[{"c", "[", 
              RowBox[{"n", "-", "4"}], "]"}]}], "+", 
            RowBox[{"f5", " ", 
             RowBox[{"c", "[", 
              RowBox[{"n", "-", "5"}], "]"}]}]}], "\[Equal]", "0"}], ",", 
          RowBox[{
           RowBox[{"c", "[", "0", "]"}], "\[Equal]", "1"}], ",", 
          RowBox[{
           RowBox[{"c", "[", 
            RowBox[{"-", "1"}], "]"}], "\[Equal]", "0"}], ",", 
          RowBox[{
           RowBox[{"c", "[", 
            RowBox[{"-", "2"}], "]"}], "\[Equal]", "0"}], ",", 
          RowBox[{
           RowBox[{"c", "[", 
            RowBox[{"-", "3"}], "]"}], "\[Equal]", "0"}], ",", 
          RowBox[{
           RowBox[{"c", "[", 
            RowBox[{"-", "4"}], "]"}], "\[Equal]", "0"}]}], "}"}], ",", "c", 
        ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "0", ",", "N"}], "}"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Psi]out", "[", 
   RowBox[{
   "l_", ",", "m_", ",", "kout_", ",", "a_", ",", "M_", ",", "\[Omega]_", ",",
     "r_", ",", "c_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Exp", "[", 
    RowBox[{"\[ImaginaryI]", " ", "\[Omega]", " ", 
     RowBox[{"(", 
      RowBox[{"r", "+", 
       RowBox[{"M", " ", 
        RowBox[{"Log", "[", 
         FractionBox[
          RowBox[{
           SuperscriptBox["r", "2"], "-", 
           RowBox[{"2", " ", "M", " ", "r"}], " ", "+", 
           SuperscriptBox["a", "2"]}], 
          SuperscriptBox["M", "2"]], "]"}]}], "+", 
       RowBox[{
        FractionBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", 
            SuperscriptBox["M", "2"]}], "-", 
           SuperscriptBox["a", "2"]}], ")"}], 
         RowBox[{"2", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["M", "2"], "-", 
            SuperscriptBox["a", "2"]}]]}]], 
        RowBox[{"Log", "[", 
         FractionBox[
          RowBox[{"r", "-", "M", "-", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["M", "2"], "-", 
             SuperscriptBox["a", "2"]}]]}], 
          RowBox[{"r", "-", "M", "+", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["M", "2"], "-", 
             SuperscriptBox["a", "2"]}]]}]], "]"}]}]}], ")"}]}], "]"}], 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"[", 
        RowBox[{"n", "+", "1"}], "]"}], "]"}], 
      SuperscriptBox["r", 
       RowBox[{"-", "n"}]]}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", "kout"}], "}"}]}], "]"}]}]}]}], "Input",
 CellLabel->"In[10]:=",ExpressionUUID->"0c98fdac-34c6-4d25-a777-31bbf17cd76d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Init\[Psi]in", "[", 
   RowBox[{
   "l_", ",", "m_", ",", "kin_", ",", "a_", ",", "M_", ",", "\[Omega]i_"}], 
   "]"}], " ", ":=", " ", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"i", " ", "=", " ", "l"}], ",", " ", 
      RowBox[{"j", "=", " ", "m"}], " ", ",", " ", 
      RowBox[{"N", "=", "kin"}], ",", " ", 
      RowBox[{"s", " ", "=", " ", "a"}], ",", " ", 
      RowBox[{"\[CapitalMu]", "=", "M"}], ",", "f", ",", "k", ",", 
      RowBox[{"\[Omega]", "=", "\[Omega]i"}], ",", "\[Gamma]", ",", "rp", ",",
       "\[Lambda]"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rp", "=", " ", 
      RowBox[{"\[CapitalMu]", "+", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["\[CapitalMu]", "2"], "-", 
         SuperscriptBox["s", "2"]}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]", " ", "=", " ", 
      FractionBox[
       RowBox[{
        RowBox[{"2", "\[CapitalMu]", " ", "rp", " ", "\[Omega]"}], "-", 
        RowBox[{"s", " ", "j"}]}], 
       SuperscriptBox["rp", "2"]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Lambda]", " ", "=", " ", 
      RowBox[{
       RowBox[{"SpinWeightedSpheroidalEigenvalue", "[", 
        RowBox[{"0", ",", "i", ",", "j", ",", 
         RowBox[{"s", " ", "\[Omega]"}]}], "]"}], "-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"s", " ", "\[Omega]"}], ")"}], "2"], "+", 
       RowBox[{"2", " ", "j", " ", "s", " ", "\[Omega]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"f", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          SuperscriptBox["s", "4"], " ", 
          RowBox[{"(", 
           RowBox[{"2", "-", 
            RowBox[{"3", " ", "k"}], "+", 
            SuperscriptBox["k", "2"]}], ")"}]}], "-", 
         RowBox[{"4", " ", "s", " ", "j", " ", "\[CapitalMu]", " ", 
          SuperscriptBox["rp", "3"], " ", "\[Omega]"}], "+", 
         RowBox[{
          SuperscriptBox["s", "2"], " ", "rp", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"rp", " ", 
             RowBox[{"(", 
              RowBox[{"2", "+", 
               RowBox[{"12", " ", 
                SuperscriptBox["k", "2"]}], "+", 
               SuperscriptBox["j", "2"], "+", 
               RowBox[{"k", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "18"}], "-", 
                  RowBox[{
                  "8", " ", "\[ImaginaryI]", " ", "rp", " ", "\[Gamma]"}]}], 
                 ")"}]}], "-", "\[Lambda]", "+", 
               RowBox[{
                SuperscriptBox["rp", "2"], " ", 
                SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}], "+", 
            RowBox[{"\[CapitalMu]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "6"}], "+", 
               RowBox[{"24", " ", "k"}], "-", 
               RowBox[{"12", " ", 
                SuperscriptBox["k", "2"]}], "+", 
               RowBox[{"2", " ", 
                SuperscriptBox["rp", "2"], " ", 
                SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["rp", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"9", " ", "k"}], "+", 
               RowBox[{"6", " ", 
                SuperscriptBox["k", "2"]}]}], ")"}], " ", 
             SuperscriptBox["\[CapitalMu]", "2"]}], "+", 
            RowBox[{"2", " ", "\[CapitalMu]", " ", "rp", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "-", 
               RowBox[{"20", " ", 
                SuperscriptBox["k", "2"]}], "+", 
               RowBox[{"2", " ", "k", " ", 
                RowBox[{"(", 
                 RowBox[{"12", "+", 
                  RowBox[{
                  "5", " ", "\[ImaginaryI]", " ", "rp", " ", "\[Gamma]"}]}], 
                 ")"}]}], "+", "\[Lambda]"}], ")"}]}], "-", 
            RowBox[{
             SuperscriptBox["rp", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "15"}], " ", 
                SuperscriptBox["k", "2"]}], "+", 
               RowBox[{"3", " ", "k", " ", 
                RowBox[{"(", 
                 RowBox[{"5", "+", 
                  RowBox[{
                  "4", " ", "\[ImaginaryI]", " ", "rp", " ", "\[Gamma]"}]}], 
                 ")"}]}], "+", "\[Lambda]", "+", 
               RowBox[{
                SuperscriptBox["rp", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["\[Gamma]", "2"], "-", 
                  SuperscriptBox["\[Omega]", "2"]}], ")"}]}]}], ")"}]}]}], 
           ")"}]}]}], ",", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "6"}], " ", "s", " ", "j", " ", "\[CapitalMu]", " ", 
            SuperscriptBox["rp", "2"], " ", "\[Omega]"}], "+", 
           RowBox[{
            SuperscriptBox["s", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"rp", " ", 
               RowBox[{"(", 
                RowBox[{"13", "+", 
                 RowBox[{"4", " ", 
                  SuperscriptBox["k", "2"]}], "+", 
                 SuperscriptBox["j", "2"], "+", 
                 RowBox[{
                 "6", " ", "\[ImaginaryI]", " ", "rp", " ", "\[Gamma]"}], "+", 
                 RowBox[{"k", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "15"}], "-", 
                    RowBox[{
                    "6", " ", "\[ImaginaryI]", " ", "rp", " ", "\[Gamma]"}]}],
                    ")"}]}], "-", "\[Lambda]", "+", 
                 RowBox[{"2", " ", 
                  SuperscriptBox["rp", "2"], " ", 
                  SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}], "+", 
              RowBox[{"\[CapitalMu]", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "10"}], "+", 
                 RowBox[{"9", " ", "k"}], "-", 
                 RowBox[{"2", " ", 
                  SuperscriptBox["k", "2"]}], "+", 
                 RowBox[{"3", " ", 
                  SuperscriptBox["rp", "2"], " ", 
                  SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}]}], ")"}]}], 
           "+", 
           RowBox[{"rp", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"26", "-", 
                 RowBox[{"30", " ", "k"}], "+", 
                 RowBox[{"8", " ", 
                  SuperscriptBox["k", "2"]}]}], ")"}], " ", 
               SuperscriptBox["\[CapitalMu]", "2"]}], "+", 
              RowBox[{"\[CapitalMu]", " ", "rp", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "49"}], "-", 
                 RowBox[{"20", " ", 
                  SuperscriptBox["k", "2"]}], "-", 
                 RowBox[{
                 "20", " ", "\[ImaginaryI]", " ", "rp", " ", "\[Gamma]"}], 
                 "+", 
                 RowBox[{"k", " ", 
                  RowBox[{"(", 
                   RowBox[{"66", "+", 
                    RowBox[{
                    "20", " ", "\[ImaginaryI]", " ", "rp", " ", 
                    "\[Gamma]"}]}], ")"}]}], "+", 
                 RowBox[{"3", " ", "\[Lambda]"}]}], ")"}]}], "+", 
              RowBox[{
               SuperscriptBox["rp", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"20", "+", 
                 RowBox[{"10", " ", 
                  SuperscriptBox["k", "2"]}], "+", 
                 RowBox[{
                 "15", " ", "\[ImaginaryI]", " ", "rp", " ", "\[Gamma]"}], 
                 "+", 
                 RowBox[{"k", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "30"}], "-", 
                    RowBox[{
                    "15", " ", "\[ImaginaryI]", " ", "rp", " ", 
                    "\[Gamma]"}]}], ")"}]}], "-", 
                 RowBox[{"2", " ", "\[Lambda]"}], "-", 
                 RowBox[{"3", " ", 
                  SuperscriptBox["rp", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["\[Gamma]", "2"], "-", 
                    SuperscriptBox["\[Omega]", "2"]}], ")"}]}]}], ")"}]}]}], 
             ")"}]}]}], ")"}]}], ",", 
        RowBox[{
         RowBox[{"4", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", "k"}], ")"}], "2"], " ", 
          SuperscriptBox["\[CapitalMu]", "2"]}], "+", 
         RowBox[{"2", " ", "\[CapitalMu]", " ", "rp", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "71"}], "-", 
            RowBox[{"10", " ", 
             SuperscriptBox["k", "2"]}], "-", 
            RowBox[{"40", " ", "\[ImaginaryI]", " ", "rp", " ", "\[Gamma]"}], 
            "+", 
            RowBox[{"k", " ", 
             RowBox[{"(", 
              RowBox[{"54", "+", 
               RowBox[{
               "20", " ", "\[ImaginaryI]", " ", "rp", " ", "\[Gamma]"}]}], 
              ")"}]}], "+", 
            RowBox[{"3", " ", "\[Lambda]"}]}], ")"}]}], "-", 
         RowBox[{
         "12", " ", "s", " ", "j", " ", "\[CapitalMu]", " ", "rp", " ", 
          "\[Omega]"}], "+", 
         RowBox[{
          SuperscriptBox["s", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"18", "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["k", "2"]}], "+", 
            SuperscriptBox["j", "2"], "+", 
            RowBox[{"16", " ", "\[ImaginaryI]", " ", "rp", " ", "\[Gamma]"}], 
            "+", 
            RowBox[{"k", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "12"}], "-", 
               RowBox[{
               "8", " ", "\[ImaginaryI]", " ", "rp", " ", "\[Gamma]"}]}], 
              ")"}]}], "-", "\[Lambda]", "+", 
            RowBox[{"6", " ", "\[CapitalMu]", " ", "rp", " ", 
             SuperscriptBox["\[Omega]", "2"]}], "+", 
            RowBox[{"6", " ", 
             SuperscriptBox["rp", "2"], " ", 
             SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["rp", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"90", "+", 
            RowBox[{"15", " ", 
             SuperscriptBox["k", "2"]}], "+", 
            RowBox[{"80", " ", "\[ImaginaryI]", " ", "rp", " ", "\[Gamma]"}], 
            "+", 
            RowBox[{"k", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "75"}], "-", 
               RowBox[{
               "40", " ", "\[ImaginaryI]", " ", "rp", " ", "\[Gamma]"}]}], 
              ")"}]}], "-", 
            RowBox[{"6", " ", "\[Lambda]"}], "-", 
            RowBox[{"15", " ", 
             SuperscriptBox["rp", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[Gamma]", "2"], "-", 
               SuperscriptBox["\[Omega]", "2"]}], ")"}]}]}], ")"}]}]}], ",", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", 
            SuperscriptBox["s", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "3"}], "+", "k"}], ")"}], " ", "\[Gamma]"}], "-", 
           RowBox[{"15", " ", "\[ImaginaryI]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "3"}], "+", "k"}], ")"}], " ", 
            SuperscriptBox["rp", "2"], " ", "\[Gamma]"}], "-", 
           RowBox[{"10", " ", 
            SuperscriptBox["rp", "3"], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["\[Gamma]", "2"], "-", 
              SuperscriptBox["\[Omega]", "2"]}], ")"}]}], "+", 
           RowBox[{"\[CapitalMu]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "28"}], "-", 
              RowBox[{"2", " ", 
               SuperscriptBox["k", "2"]}], "-", 
              RowBox[{
              "30", " ", "\[ImaginaryI]", " ", "rp", " ", "\[Gamma]"}], "+", 
              RowBox[{"5", " ", "k", " ", 
               RowBox[{"(", 
                RowBox[{"3", "+", 
                 RowBox[{
                 "2", " ", "\[ImaginaryI]", " ", "rp", " ", "\[Gamma]"}]}], 
                ")"}]}], "+", "\[Lambda]", "-", 
              RowBox[{"2", " ", "s", " ", "j", " ", "\[Omega]"}], "+", 
              RowBox[{
               SuperscriptBox["s", "2"], " ", 
               SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}], "+", 
           RowBox[{"rp", " ", 
            RowBox[{"(", 
             RowBox[{"36", "-", 
              RowBox[{"21", " ", "k"}], "+", 
              RowBox[{"3", " ", 
               SuperscriptBox["k", "2"]}], "-", 
              RowBox[{"2", " ", "\[Lambda]"}], "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["s", "2"], " ", 
               SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}]}], ")"}]}], ",", 
        RowBox[{"4", "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "4"}], "+", "k"}], ")"}], "2"], "-", "k", "+", 
         RowBox[{"4", " ", "\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "4"}], "+", "k"}], ")"}], " ", "\[CapitalMu]", " ", 
          "\[Gamma]"}], "-", 
         RowBox[{"12", " ", "\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "4"}], "+", "k"}], ")"}], " ", "rp", " ", 
          "\[Gamma]"}], "-", "\[Lambda]", "+", 
         RowBox[{
          SuperscriptBox["s", "2"], " ", 
          SuperscriptBox["\[Omega]", "2"]}], "-", 
         RowBox[{"15", " ", 
          SuperscriptBox["rp", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["\[Gamma]", "2"], "-", 
            SuperscriptBox["\[Omega]", "2"]}], ")"}]}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "5"}], "+", "k"}], ")"}], " ", "\[Gamma]"}], "-", 
         RowBox[{"6", " ", "rp", " ", 
          SuperscriptBox["\[Gamma]", "2"]}], "+", 
         RowBox[{"6", " ", "rp", " ", 
          SuperscriptBox["\[Omega]", "2"]}]}], ",", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["\[Gamma]", "2"]}], "+", 
         SuperscriptBox["\[Omega]", "2"]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"cs", " ", "=", " ", 
      RowBox[{"RecurrenceTable", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"c", "[", "k", "]"}], " ", 
             RowBox[{
             "f", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "+", 
            RowBox[{
             RowBox[{"c", "[", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "k"}], "]"}], " ", 
             RowBox[{
             "f", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
            "+", 
            RowBox[{
             RowBox[{"c", "[", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "k"}], "]"}], " ", 
             RowBox[{
             "f", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
            "+", 
            RowBox[{
             RowBox[{"c", "[", 
              RowBox[{
               RowBox[{"-", "3"}], "+", "k"}], "]"}], " ", 
             RowBox[{
             "f", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
            "+", 
            RowBox[{
             RowBox[{"c", "[", 
              RowBox[{
               RowBox[{"-", "4"}], "+", "k"}], "]"}], " ", 
             RowBox[{
             "f", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}]}], 
            "+", 
            RowBox[{
             RowBox[{"c", "[", 
              RowBox[{
               RowBox[{"-", "5"}], "+", "k"}], "]"}], " ", 
             RowBox[{
             "f", "\[LeftDoubleBracket]", "6", "\[RightDoubleBracket]"}]}], 
            "+", 
            RowBox[{
             RowBox[{"c", "[", 
              RowBox[{
               RowBox[{"-", "6"}], "+", "k"}], "]"}], " ", 
             RowBox[{
             "f", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}]}]}], 
           "\[Equal]", "0"}], ",", 
          RowBox[{
           RowBox[{"c", "[", "0", "]"}], "\[Equal]", "1"}], ",", 
          RowBox[{
           RowBox[{"c", "[", 
            RowBox[{"-", "1"}], "]"}], "\[Equal]", "0"}], ",", 
          RowBox[{
           RowBox[{"c", "[", 
            RowBox[{"-", "2"}], "]"}], "\[Equal]", "0"}], ",", 
          RowBox[{
           RowBox[{"c", "[", 
            RowBox[{"-", "3"}], "]"}], "\[Equal]", "0"}], ",", 
          RowBox[{
           RowBox[{"c", "[", 
            RowBox[{"-", "4"}], "]"}], "\[Equal]", "0"}], ",", 
          RowBox[{
           RowBox[{"c", "[", 
            RowBox[{"-", "5"}], "]"}], "\[Equal]", "0"}]}], "}"}], ",", "c", 
        ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "0", ",", "N"}], "}"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\n", 
 RowBox[{
  RowBox[{"\[Psi]in", "[", 
   RowBox[{
   "l_", ",", "m_", ",", "kin_", ",", "a_", ",", "M_", ",", "\[Omega]_", ",", 
    "r_", ",", "c_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", 
     RowBox[{"(", 
      FractionBox[
       RowBox[{
        RowBox[{"2", "M", 
         RowBox[{"(", 
          RowBox[{"M", "+", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["M", "2"], "-", 
             SuperscriptBox["a", "2"]}]]}], ")"}], "\[Omega]"}], "-", 
        RowBox[{"a", " ", "m"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"M", "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["M", "2"], "-", 
            SuperscriptBox["a", "2"]}]]}], ")"}], "2"]], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"r", "+", 
       RowBox[{"M", " ", 
        RowBox[{"Log", "[", 
         FractionBox[
          RowBox[{
           SuperscriptBox["r", "2"], "-", 
           RowBox[{"2", " ", "M", " ", "r"}], " ", "+", 
           SuperscriptBox["a", "2"]}], 
          SuperscriptBox["M", "2"]], "]"}]}], "+", 
       RowBox[{
        FractionBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", 
            SuperscriptBox["M", "2"]}], "-", 
           SuperscriptBox["a", "2"]}], ")"}], 
         RowBox[{"2", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["M", "2"], "-", 
            SuperscriptBox["a", "2"]}]]}]], 
        RowBox[{"Log", "[", 
         FractionBox[
          RowBox[{"r", "-", "M", "-", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["M", "2"], "-", 
             SuperscriptBox["a", "2"]}]]}], 
          RowBox[{"r", "-", "M", "+", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["M", "2"], "-", 
             SuperscriptBox["a", "2"]}]]}]], "]"}]}]}], ")"}]}], "]"}], 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"c", "[", 
       RowBox[{"[", 
        RowBox[{"n", "+", "1"}], "]"}], "]"}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"r", "-", "M", "-", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["M", "2"], "-", 
           SuperscriptBox["a", "2"]}]]}], ")"}], "n"]}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", "kin"}], "}"}]}], "]"}]}]}]}], "Input",
 CellLabel->"In[12]:=",ExpressionUUID->"549b09d1-4ac0-447f-bc15-a03348489d69"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"rs", "[", "r_", "]"}], ":=", 
   RowBox[{"r", "+", 
    RowBox[{"M", " ", 
     RowBox[{"Log", "[", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"r", "-", "M", "-", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["M", "2"], "-", 
            SuperscriptBox["a", "2"]}]]}], ")"}], 
        RowBox[{"(", 
         RowBox[{"r", "-", "M", "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["M", "2"], "-", 
            SuperscriptBox["a", "2"]}]]}], ")"}]}], 
       SuperscriptBox["M", "2"]], "]"}]}], " ", "+", 
    RowBox[{
     FractionBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", 
         SuperscriptBox["M", "2"]}], "-", 
        SuperscriptBox["a", "2"]}], ")"}], 
      RowBox[{"2", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["M", "2"], "-", 
         SuperscriptBox["a", "2"]}]]}]], " ", 
     RowBox[{"Log", "[", 
      FractionBox[
       RowBox[{"r", "-", "M", "-", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["M", "2"], "-", 
          SuperscriptBox["a", "2"]}]]}], 
       RowBox[{"r", "-", "M", "+", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["M", "2"], "-", 
          SuperscriptBox["a", "2"]}]]}]], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalDelta]", "[", 
    RowBox[{"r_", ",", "M_", ",", "a_"}], "]"}], ":=", 
   RowBox[{
    SuperscriptBox["r", "2"], "-", 
    RowBox[{"2", "M", " ", "r"}], "+", 
    SuperscriptBox["a", "2"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"W", "[", 
   RowBox[{
   "r_", ",", "M_", ",", "a_", ",", "\[Omega]_", ",", "m_", ",", 
    "\[Lambda]_"}], "]"}], ":=", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["r", "2"], "+", 
          SuperscriptBox["a", "2"]}], ")"}], "\[Omega]"}], "-", 
       RowBox[{"a", " ", "m"}]}], 
      SuperscriptBox["r", "2"]], ")"}], "2"], "-", 
   RowBox[{
    FractionBox[
     RowBox[{"\[CapitalDelta]", "[", 
      RowBox[{"r", ",", "M", ",", "a"}], "]"}], 
     SuperscriptBox["r", "4"]], 
    RowBox[{"(", 
     RowBox[{"\[Lambda]", "-", 
      RowBox[{"2", " ", "a", " ", "m", " ", "\[Omega]"}], " ", "+", 
      RowBox[{
       SuperscriptBox["a", "2"], 
       SuperscriptBox["\[Omega]", "2"]}], "+", 
      FractionBox[
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"M", " ", "r"}], "-", 
          SuperscriptBox["a", "2"]}], ")"}]}], 
       SuperscriptBox["r", "2"]]}], ")"}]}]}]}]}], "Input",
 CellLabel->"In[14]:=",ExpressionUUID->"4d6101ea-3549-494e-a4e1-7d343e25ed00"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"l00Coeffs", "[", 
    RowBox[{"li_", ",", "Mi_", ",", "ai_", ",", "r0i_", ",", "xi_"}], "]"}], ":=",
    "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"l", "=", "li"}], ",", 
       RowBox[{"M", "=", "Mi"}], ",", 
       RowBox[{"a", "=", "ai"}], ",", 
       RowBox[{"r0", "=", "r0i"}], ",", 
       RowBox[{"x", "=", "xi"}], ",", "\[CapitalOmega]\[Theta]", ",", 
       "\[CapitalOmega]\[Phi]", ",", "\[Lambda]", ",", "Freqs", ",", "Wr", 
       ",", "\[Alpha]", ",", "x0", ",", "P0", ",", "Q0", ",", "dP0", ",", 
       "dQ0", ",", "v", ",", "cHor", ",", "cInf"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Freqs", " ", "=", " ", 
       RowBox[{"KerrGeoFrequencies", "[", 
        RowBox[{"a", ",", "r0", ",", "0", ",", "x"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[CapitalOmega]\[Theta]", "=", 
       RowBox[{"Freqs", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[CapitalOmega]\[Phi]", "=", 
       RowBox[{"Freqs", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"x0", " ", "=", " ", 
       FractionBox[
        RowBox[{"r0", "-", "M"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["M", "2"], "-", 
          SuperscriptBox["a", "2"]}]]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"P0", "=", " ", 
       RowBox[{"LegendreP", "[", 
        RowBox[{"l", ",", "0", ",", "3", ",", "x0"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Q0", "=", " ", 
       RowBox[{"LegendreQ", "[", 
        RowBox[{"l", ",", "x0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dP0", "=", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"LegendreP", "[", 
           RowBox[{"l", ",", "v"}], "]"}], ",", "v"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{"v", "->", "x0"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dQ0", "=", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"LegendreQ", "[", 
           RowBox[{"l", ",", "v"}], "]"}], ",", "v"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{"v", "->", "x0"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Wr", " ", "=", " ", 
       RowBox[{
        FractionBox[
         SuperscriptBox["r0", "2"], 
         SqrtBox[
          RowBox[{
           SuperscriptBox["M", "2"], "-", 
           SuperscriptBox["a", "2"]}]]], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"dQ0", " ", "P0"}], " ", "-", " ", 
          RowBox[{"Q0", " ", "dP0"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Lambda]", " ", "=", " ", 
       RowBox[{"SpinWeightedSpheroidalEigenvalue", "[", 
        RowBox[{"0", ",", "l", ",", "0", ",", "0"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Alpha]", " ", "=", " ", 
       RowBox[{"SourceNonZero", "[", 
        RowBox[{
        "l", ",", "0", ",", "0", ",", "M", ",", "a", ",", "r0", ",", "x"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"cInf", " ", "=", " ", 
       RowBox[{"\[Alpha]", " ", "r0", 
        FractionBox["P0", "Wr"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cHor", " ", "=", " ", 
       FractionBox[
        RowBox[{"\[Alpha]", " ", "r0", " ", 
         RowBox[{"Re", "[", "Q0", "]"}]}], "Wr"]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"cInf", ",", "cHor"}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lmkCoeffs", "[", 
    RowBox[{
    "li_", ",", "mi_", ",", "ki_", ",", "Mi_", ",", "ai_", ",", "r0i_", ",", 
     "xi_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"l", "=", "li"}], ",", 
       RowBox[{"m", "=", "mi"}], ",", 
       RowBox[{"k", "=", "ki"}], ",", 
       RowBox[{"M", "=", "Mi"}], ",", 
       RowBox[{"a", "=", "ai"}], ",", 
       RowBox[{"r0", "=", "r0i"}], ",", 
       RowBox[{"x", "=", "xi"}], ",", "\[CapitalOmega]\[Theta]", ",", 
       "\[CapitalOmega]\[Phi]", ",", "\[Omega]", ",", "\[Lambda]", ",", 
       "Freqs", ",", "kout", ",", "kin", ",", "Outcs", ",", "Incs", ",", 
       "rout", ",", "rin", ",", "OuterBoundary", ",", "InnerBoundary", ",", 
       "OuterDeriv", ",", "InnerDeriv", ",", " ", "N\[Psi]in", ",", 
       "N\[Psi]out", ",", "\[Psi]", ",", "\[Alpha]", ",", "cHor", ",", 
       "cInf"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Freqs", " ", "=", " ", 
       RowBox[{"KerrGeoFrequencies", "[", 
        RowBox[{"a", ",", "r0", ",", "0", ",", "x"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[CapitalOmega]\[Theta]", "=", 
       RowBox[{"Freqs", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[CapitalOmega]\[Phi]", "=", 
       RowBox[{"Freqs", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Omega]", "=", 
       RowBox[{
        RowBox[{"m", " ", "\[CapitalOmega]\[Phi]"}], " ", "+", " ", 
        RowBox[{"k", " ", "\[CapitalOmega]\[Theta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Lambda]", " ", "=", " ", 
       RowBox[{
        RowBox[{"SpinWeightedSpheroidalEigenvalue", "[", 
         RowBox[{"0", ",", "l", ",", "m", ",", 
          RowBox[{"a", " ", "\[Omega]"}]}], "]"}], "-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"a", " ", "\[Omega]"}], ")"}], "2"], "+", 
        RowBox[{"2", "m", " ", 
         RowBox[{"(", 
          RowBox[{"a", " ", "\[Omega]"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Alpha]", " ", "=", " ", 
       RowBox[{"Source", "[", 
        RowBox[{
        "l", ",", "m", ",", "k", ",", "M", ",", "a", ",", "r0", ",", "x"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"kin", " ", "=", " ", 
       RowBox[{"kout", " ", "=", " ", "100"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rin", " ", "=", " ", 
       RowBox[{
        RowBox[{
         SuperscriptBox["10", 
          RowBox[{"-", "5"}]], "M"}], "+", "M", "+", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["M", "2"], "-", 
          SuperscriptBox["a", "2"]}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rout", "=", 
       SuperscriptBox["10", "5"]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Outcs", " ", "=", " ", 
       RowBox[{"Init\[Psi]out", "[", 
        RowBox[{
        "l", ",", "m", ",", "kout", ",", "a", ",", "M", ",", "\[Omega]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Incs", " ", "=", " ", 
       RowBox[{"Init\[Psi]in", "[", 
        RowBox[{
        "l", ",", "m", ",", "kin", ",", "a", ",", "M", ",", "\[Omega]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"OuterBoundary", "=", 
       RowBox[{"\[Psi]out", "[", 
        RowBox[{
        "l", ",", "m", ",", "kout", ",", "a", ",", "M", ",", "\[Omega]", ",", 
         "rout", ",", "Outcs"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"InnerBoundary", "=", 
       RowBox[{"\[Psi]in", "[", 
        RowBox[{
        "l", ",", "m", ",", "kin", ",", "a", ",", "M", ",", "\[Omega]", ",", 
         "rin", ",", "Incs"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"OuterDeriv", " ", "=", " ", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"\[Psi]out", "[", 
           RowBox[{
           "l", ",", "m", ",", "kout", ",", "a", ",", "M", ",", "\[Omega]", 
            ",", "r", ",", "Outcs"}], "]"}], ",", "r"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{"r", "\[Rule]", "rout"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"InnerDeriv", " ", "=", " ", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"\[Psi]in", "[", 
           RowBox[{
           "l", ",", "m", ",", "kin", ",", "a", ",", "M", ",", "\[Omega]", 
            ",", "r", ",", "Incs"}], "]"}], ",", "r"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{"r", "\[Rule]", "rin"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"N\[Psi]in", "=", 
       RowBox[{"\[Psi]", "/.", 
        RowBox[{
         RowBox[{"NDSolve", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                FractionBox[
                 SuperscriptBox[
                  RowBox[{"\[CapitalDelta]", "[", 
                   RowBox[{"r", ",", "M", ",", "a"}], "]"}], "2"], 
                 SuperscriptBox["r", "4"]], 
                RowBox[{
                 RowBox[{"\[Psi]", "''"}], "[", "r", "]"}]}], "+", 
               RowBox[{
                FractionBox[
                 RowBox[{"2", 
                  RowBox[{"\[CapitalDelta]", "[", 
                   RowBox[{"r", ",", "M", ",", "a"}], "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    SuperscriptBox["r", "2"], 
                    RowBox[{"(", 
                    RowBox[{"r", "-", "M"}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"\[CapitalDelta]", "[", 
                    RowBox[{"r", ",", "M", ",", "a"}], "]"}], "r"}]}], 
                   ")"}]}], 
                 SuperscriptBox["r", "6"]], 
                RowBox[{
                 RowBox[{"\[Psi]", "'"}], "[", "r", "]"}]}], "+", 
               RowBox[{
                RowBox[{"W", "[", 
                 RowBox[{
                 "r", ",", "M", ",", "a", ",", "\[Omega]", ",", "m", ",", 
                  "\[Lambda]"}], "]"}], 
                RowBox[{"\[Psi]", "[", "r", "]"}]}]}], "\[Equal]", "0"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Psi]", "'"}], "[", "rin", "]"}], "\[Equal]", 
              "InnerDeriv"}], ",", 
             RowBox[{
              RowBox[{"\[Psi]", "[", "rin", "]"}], "==", "InnerBoundary"}]}], 
            "}"}], ",", "\[Psi]", ",", 
           RowBox[{"{", 
            RowBox[{"r", ",", "rin", ",", "r0"}], "}"}], ",", 
           RowBox[{"WorkingPrecision", "\[Rule]", "32"}], ",", 
           RowBox[{"MaxSteps", "\[Rule]", "\[Infinity]"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"N\[Psi]out", "=", 
       RowBox[{"\[Psi]", "/.", 
        RowBox[{
         RowBox[{"NDSolve", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                FractionBox[
                 SuperscriptBox[
                  RowBox[{"\[CapitalDelta]", "[", 
                   RowBox[{"r", ",", "M", ",", "a"}], "]"}], "2"], 
                 SuperscriptBox["r", "4"]], 
                RowBox[{
                 RowBox[{"\[Psi]", "''"}], "[", "r", "]"}]}], "+", 
               RowBox[{
                FractionBox[
                 RowBox[{"2", 
                  RowBox[{"\[CapitalDelta]", "[", 
                   RowBox[{"r", ",", "M", ",", "a"}], "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    SuperscriptBox["r", "2"], 
                    RowBox[{"(", 
                    RowBox[{"r", "-", "M"}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"\[CapitalDelta]", "[", 
                    RowBox[{"r", ",", "M", ",", "a"}], "]"}], "r"}]}], 
                   ")"}]}], 
                 SuperscriptBox["r", "6"]], 
                RowBox[{
                 RowBox[{"\[Psi]", "'"}], "[", "r", "]"}]}], "+", 
               RowBox[{
                RowBox[{"W", "[", 
                 RowBox[{
                 "r", ",", "M", ",", "a", ",", "\[Omega]", ",", "m", ",", 
                  "\[Lambda]"}], "]"}], 
                RowBox[{"\[Psi]", "[", "r", "]"}]}]}], "\[Equal]", "0"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Psi]", "'"}], "[", "rout", "]"}], "\[Equal]", 
              "OuterDeriv"}], ",", 
             RowBox[{
              RowBox[{"\[Psi]", "[", "rout", "]"}], "\[Equal]", 
              "OuterBoundary"}]}], "}"}], ",", "\[Psi]", ",", 
           RowBox[{"{", 
            RowBox[{"r", ",", "rout", ",", "r0"}], "}"}], ",", 
           RowBox[{"WorkingPrecision", "\[Rule]", "32"}], ",", 
           RowBox[{"MaxSteps", "\[Rule]", "\[Infinity]"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"cHor", " ", "=", " ", 
       RowBox[{"\[Alpha]", 
        FractionBox[
         RowBox[{"N\[Psi]out", "[", "r0", "]"}], 
         RowBox[{
          RowBox[{
           RowBox[{"N\[Psi]in", "[", "r0", "]"}], 
           RowBox[{
            RowBox[{"N\[Psi]out", "'"}], "[", "r0", "]"}]}], "-", 
          RowBox[{
           RowBox[{"N\[Psi]out", "[", "r0", "]"}], 
           RowBox[{
            RowBox[{"N\[Psi]in", "'"}], "[", "r0", "]"}]}]}]]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"cInf", " ", "=", " ", 
       RowBox[{"cHor", " ", 
        FractionBox[
         RowBox[{"N\[Psi]in", "[", "r0", "]"}], 
         RowBox[{"N\[Psi]out", "[", "r0", "]"}]]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"cInf", ",", "cHor"}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GenCoeff", "[", 
   RowBox[{
   "li_", ",", "mi_", ",", "ki_", ",", "Mi_", ",", "ai_", ",", "r0i_", ",", 
    "xi_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"mi", "==", "0"}], "&&", 
     RowBox[{"ki", "==", "0"}]}], ",", 
    RowBox[{"l00Coeffs", "[", 
     RowBox[{"li", ",", "Mi", ",", "ai", ",", "r0i", ",", "xi"}], "]"}], ",", 
    RowBox[{"lmkCoeffs", "[", 
     RowBox[{
     "li", ",", "mi", ",", "ki", ",", "Mi", ",", "ai", ",", "r0i", ",", 
      "xi"}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8487316883877897`*^9, 3.848731890433859*^9}, {
  3.8487319262766776`*^9, 3.8487319631617084`*^9}, {3.8487319951080155`*^9, 
  3.8487320034713545`*^9}, {3.8487321944669404`*^9, 3.848732641180845*^9}, {
  3.84873322824524*^9, 3.848733229666269*^9}, {3.851763140430753*^9, 
  3.8517631466065397`*^9}, {3.8532188688666244`*^9, 3.853218877326438*^9}, {
  3.853219618936982*^9, 3.853219621306776*^9}, {3.8532197705365925`*^9, 
  3.8532198001968536`*^9}, {3.853226542906019*^9, 3.8532265495524087`*^9}, {
  3.8532388883199573`*^9, 3.8532388907932005`*^9}, {3.853819404046075*^9, 
  3.8538194051139956`*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"f3b4779e-959c-42ce-b1cf-63a34ac7859a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"M", "=", "1`50"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", ".998`50"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r0", "=", "10`50"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x", "=", 
   RowBox[{"Cos", "[", " ", 
    RowBox[{"\[Pi]", "/", "6`50"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lmax", " ", "=", " ", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kmax", " ", "=", " ", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"orbit", " ", "=", " ", 
   RowBox[{"KerrGeoOrbit", "[", 
    RowBox[{"a", ",", "r0", ",", "0", ",", "x"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"orbit", "[", "\"\<Energy\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"orbit", "[", "\"\<AngularMomentum\>\"", "]"}]}], "Input",
 CellChangeTimes->{{3.8487297560467086`*^9, 3.8487297816559563`*^9}, {
  3.8514064646466236`*^9, 3.85140648658825*^9}, {3.851408718692147*^9, 
  3.851408719009561*^9}, {3.851485918998037*^9, 3.8514859284575825`*^9}, {
  3.8514862309097304`*^9, 3.8514862333885612`*^9}, {3.8517616629153624`*^9, 
  3.8517616695449924`*^9}, {3.8517632499966106`*^9, 3.8517632582210894`*^9}, {
  3.8517636165665975`*^9, 3.8517636171096325`*^9}, {3.852978485315218*^9, 
  3.8529784870532007`*^9}, {3.853218249529379*^9, 3.8532182568553762`*^9}, {
  3.8532183065728865`*^9, 3.85321830713783*^9}, {3.8532184426089544`*^9, 
  3.853218452208222*^9}, {3.853218942882239*^9, 3.8532189942069364`*^9}, {
  3.8532315532239666`*^9, 3.853231553389585*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"e48b7ed5-a380-4c4d-8063-9b2f0231704f"],

Cell[BoxData["0.\
9523205280178254176952275108189242466635278290397011920485224114333144959773`\
49.04314990655042"], "Output",
 CellChangeTimes->{{3.8532189586966143`*^9, 3.8532189944688654`*^9}, 
   3.8532198264926257`*^9, 3.8532263818865414`*^9, 3.853226553650468*^9, 
   3.853231585970992*^9, 3.8538266331209307`*^9, 3.853826859602971*^9, 
   3.854188124070774*^9, 3.8541882930899153`*^9, 3.8557445893652143`*^9, 
   3.855815998224444*^9, 3.8558162985177608`*^9},
 CellLabel->"Out[27]=",ExpressionUUID->"7877ab1f-ebbb-45a1-a5d5-21b1eaf2feb5"],

Cell[BoxData["2.9985629974029998714346494355266222574514380833482902641795`47.\
83808461419337"], "Output",
 CellChangeTimes->{{3.8532189586966143`*^9, 3.8532189944688654`*^9}, 
   3.8532198264926257`*^9, 3.8532263818865414`*^9, 3.853226553650468*^9, 
   3.853231585970992*^9, 3.8538266331209307`*^9, 3.853826859602971*^9, 
   3.854188124070774*^9, 3.8541882930899153`*^9, 3.8557445893652143`*^9, 
   3.855815998224444*^9, 3.8558162985177608`*^9},
 CellLabel->"Out[28]=",ExpressionUUID->"aae1d080-a1d4-4747-a591-bb0995a308b0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GenCoeff", "[", 
  RowBox[{
  "1", ",", "0", ",", "1", ",", "1`50", ",", ".998`50", ",", "10`50", ",", 
   RowBox[{"Cos", "[", 
    RowBox[{"\[Pi]", "/", "6`50"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.855816305338823*^9, 3.8558163315051613`*^9}, {
  3.8558164278450675`*^9, 3.8558164370194454`*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"ba643993-5f42-4284-b76f-3922c5c59a17"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "0.02675862171551685`"}], "-", 
    RowBox[{"0.12133732372987246`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.0003312080311778124`", "\[VeryThinSpace]", "-", 
    RowBox[{"0.00044507030093086426`", " ", "\[ImaginaryI]"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.8558163413555984`*^9, 3.855816446427696*^9},
 CellLabel->"Out[30]=",ExpressionUUID->"d3ada9c9-efeb-4a23-ac7e-e77862eb4328"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ParallelNeeds", "[", "\"\<KerrGeodesics`\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ParallelNeeds", "[", "\"\<SpinWeightedSpheroidalHarmonics`\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Amplitudes", " ", "=", " ", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"GenCoeff", "[", 
      RowBox[{
      "l", ",", "m", ",", "k", ",", "M", ",", "a", ",", "r0", ",", "x"}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "0", ",", "lmax"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", 
       RowBox[{"-", "l"}], ",", "l"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{"-", "kmax"}], ",", "kmax"}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellLabel->"In[30]:=",ExpressionUUID->"630b6e9f-4422-4e35-8aab-8d7afcd6eddc"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.8557446176737146`*^9, 3.8558161023347797`*^9},
 CellLabel->"Out[32]=",ExpressionUUID->"f30afe8d-a4d3-4114-a3de-167b1daee7d5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SourceNonZero", "[", 
  RowBox[{"1", ",", "1", ",", "2", ",", "M", ",", "a", ",", "r0", ",", "x"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8557446230348086`*^9, 3.8557446806346455`*^9}, {
  3.8557448845842333`*^9, 3.855744888159546*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"e772c0ca-dcaf-4c25-bf42-128d21ac5902"],

Cell[BoxData[
 RowBox[{"-", "0.0000901804139326121`"}]], "Output",
 CellChangeTimes->{{3.855744668033121*^9, 3.85574468225902*^9}, 
   3.85574488929154*^9},
 CellLabel->"Out[38]=",ExpressionUUID->"aaba5955-0357-407b-bdeb-63eb54bbd940"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Freqs", "=", 
   RowBox[{"KerrGeoFrequencies", "[", 
    RowBox[{"a", ",", "r0", ",", "0", ",", "x"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalOmega]\[Theta]", " ", "=", " ", 
   RowBox[{"Freqs", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalOmega]\[Phi]", "=", 
   RowBox[{"Freqs", "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rp", " ", "=", " ", 
   RowBox[{"M", "+", 
    RowBox[{"\[Sqrt]", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["M", "2"], "-", 
       SuperscriptBox["a", "2"]}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalOmega]p", " ", "=", " ", 
   RowBox[{"a", "/", 
    RowBox[{"(", 
     RowBox[{"2", "M", " ", "rp"}], ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.848733462192252*^9, 3.84873349936938*^9}, {
  3.8487336628834944`*^9, 3.8487337030096645`*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"9efff70a-491e-4c24-acc1-92a1bf64f8e4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Eout", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"4", "\[Pi]"}], ")"}]}], ")"}], 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"m", " ", "\[CapitalOmega]\[Phi]"}], " ", "+", " ", 
          RowBox[{"k", " ", "\[CapitalOmega]\[Theta]"}]}], ")"}], "2"], 
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"Amplitudes", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"l", "+", "1"}], ",", 
             RowBox[{"l", "+", "m", " ", "+", " ", "1"}], ",", 
             RowBox[{"kmax", "+", "k", "+", "1"}]}], "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "2"]}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "0", ",", "lmax"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"-", "l"}], ",", "l"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "0", ",", "kmax"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ein", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"M", "/", 
      RowBox[{"(", 
       RowBox[{"2", "\[Pi]", " ", "rp"}], ")"}]}], ")"}], 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"m", " ", "\[CapitalOmega]\[Phi]"}], " ", "+", " ", 
         RowBox[{"k", " ", "\[CapitalOmega]\[Theta]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"m", " ", 
          RowBox[{"(", 
           RowBox[{"\[CapitalOmega]\[Phi]", "-", "\[CapitalOmega]p"}], 
           ")"}]}], " ", "+", " ", 
         RowBox[{"k", " ", "\[CapitalOmega]\[Theta]"}]}], " ", ")"}], 
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"Amplitudes", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"l", "+", "1"}], ",", 
             RowBox[{"l", "+", "m", " ", "+", " ", "1"}], ",", 
             RowBox[{"kmax", "+", "k", "+", "1"}]}], "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}], "2"]}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "0", ",", "lmax"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"-", "l"}], ",", "l"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "0", ",", "kmax"}], "}"}]}], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8487333100624657`*^9, 3.848733429494412*^9}, {
   3.848733566185951*^9, 3.848733645125351*^9}, {3.848733679597295*^9, 
   3.848733725826651*^9}, 3.848733845187066*^9, {3.852096803227955*^9, 
   3.852096823480179*^9}, {3.853226567405303*^9, 3.85322660036425*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"97cbc5bd-003d-495c-8920-4d4b0ad5b8ca"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Init\[Psi]in", "[", 
  RowBox[{"1", ",", "0", ",", "100", ",", "a", ",", "M", ",", 
   RowBox[{
    RowBox[{"0", " ", "\[CapitalOmega]\[Phi]"}], " ", "+", " ", 
    RowBox[{"1", " ", "\[CapitalOmega]\[Theta]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.855818788173403*^9, 3.855818868718227*^9}, {
  3.8558247450802717`*^9, 3.855824745779187*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"834f52af-76e1-4bd9-99cc-3a351491ca50"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.`42.35354897038877", ",", 
   RowBox[{
   "8.7053574339505655935219065835963666131643285246706013073367`37.\
53832087778846", "+", 
    RowBox[{
    "8.5953232695213100904403357517955600827572971146339854542113`37.\
800923731204755", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
   "0.0443923062984262693076794644101650408840079307740464150666`34.\
56209874295692", "+", 
    RowBox[{
    "11.0559800434699609073436268192216433929801684050446946138635`36.\
922416206211594", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
   "17.5439821869678186843256019841929515746331467894959708159675`36.\
013558670172415", "-", 
    RowBox[{
    "4.1862685488317225741064086855200118924509181427192229320244`35.\
38511630587958", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{
    "-", "99.3935022735311693682945954229219406408982246991670621436863`35.\
54595323856916"}], "+", 
    RowBox[{
    "17.0593064414365444152897494091491105574053046499365519017177`34.\
779204409933094", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
   "582.1781936720824051578284022107325749688430482179654888691174`35.\
05621681849251", "-", 
    RowBox[{
    "65.4629093800428369204750963600735250003562366557521720031358`34.\
106406925048624", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{
    "-", "3603.6923136220806331536099851778684804078836072593963994438658`34.\
56652765874348"}], "+", 
    RowBox[{
    "231.3690763747354281889647922484295651741915880299680437814307`33.\
373679707227694", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
   "23178.072688798058152224406354159018687166811633422054514096997`34.\
07948131412792", "-", 
    RowBox[{
    "569.0839943717603601590931495714154164519879518879837638178741`32.\
46931988086825", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{
    "-", "153243.10154000872361940079957915888790561397`33.59500589122246"}], 
    "-", 
    RowBox[{
    "1327.54126398398268736982104211599101424157`31.532492604721735", " ", 
     "\[ImaginaryI]"}]}], ",", 
   RowBox[{
   "1.03438204512114301914200854357170572670176466`33.112886896979546*^6", 
    "+", 
    RowBox[{
    "38223.76596320575453266873952639395183209539`31.680407144086228", " ", 
     "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{
    "-", "7.09557565794307946527705855887987599851719688`32.6328636825457*^6"}\
], "-", 
    RowBox[{
    "435465.0268312947255107963125850962284988411`31.42072857974563", " ", 
     "\[ImaginaryI]"}]}], ",", 
   RowBox[{
   "4.930731609615993504440653140591834239708046017`32.15469816907485*^7", 
    "+", 
    RowBox[{
    "4.0761800589482861440746314124339981789364137`31.071961208530347*^6", 
     " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{
    "-", "3.4629381351327838502899843921559401120269007045`31.67818321122326*^\
8"}], "-", 
    RowBox[{
    "3.511294395873023236797086941005231083366231152`30.684142459982752*^7", 
     " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
   "2.45377181266763499828336670165083575722967303399`31.20314162317418*^9", 
    "+", 
    RowBox[{
    "2.894652680493889830078475035005621665093590019`30.27485230964669*^8", 
     " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{
    "-", "1.751866772849898035680688742230247176345345380849`30.\
729422257861007*^10"}], "-", 
    RowBox[{
    "2.32472402726771568463714443333451705632275166162`29.85224985876082*^9", 
     " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
   "1.2589000990708981000465006751145013041992429951086`30.256895859360455*^\
11", "+", 
    RowBox[{
    "1.836010186972922426915289266065530569556739930113`29.420743840581007*^\
10", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{
    "-", "9.0979070033307546985544986092994155993649655616518`29.\
7854513712903*^11"}], "-", 
    RowBox[{
    "1.4337740716185286345703067310721957335035943984045`28.982960204136884*^\
11", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
   "6.60779374123734898411551771934765224918493740754491`29.314992842918834*^\
12", "+", 
    RowBox[{
    "1.11086932592376635473665439673443687549234649085791`28.5405733040435*^\
12", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{
    "-", "4.820508091026247378414133255344740673488114266167788`28.\
845436894183745*^13"}], "-", 
    RowBox[{
    "8.55823881192884683085941894517596581362783531015684`28.094705983595276*^\
12", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
   "3.5305907192152669599879421944091542989194069664436927`28.376710654523325*^\
14", "+", 
    RowBox[{
    "6.565947286522598042520765588393893685841312057629273`27.64614108253342*^\
13", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{
    "-", "2.59506826001663018206743305507789708775555915450039402`27.\
908750088102*^15"}], "-", 
    RowBox[{
    "5.0217761597171903914370552793092359497491674982863844`27.\
195441475987415*^14", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
   "1.913599609647667539007114114196568896561482900677596495`27.\
441498629220252*^16", "+", 
    RowBox[{
    "3.83168419280197930887296834055100652953892183702414294`26.\
74302210538495*^15", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{
    "-", "1.4152358450708984209710355973015689144067553010201809785`26.\
97490606543633*^17"}], "-", 
    RowBox[{
    "2.918309826602797682706200720773863750855257428248654424`26.\
289195190628558*^16", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
   "1.049478214720686836924089889945477418`26.508927618529828*^18", "+", 
    RowBox[{
    "2.219511978875634757502966112599698929`25.83419968208612*^17", " ", 
     "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{
    "-", "7.8017172397700778967869251363875235745`26.043523183935978*^18"}], 
    "-", 
    RowBox[{
    "1.6861602025927742782517268065182320094`25.37822105349119*^18", " ", 
     "\[ImaginaryI]"}]}], ",", 
   RowBox[{
   "5.81294293618569080955350762827684803502`25.57865669767435*^19", "+", 
    RowBox[{
    "1.27983508281514441770106318634623291885`24.921404961200725*^19", " ", 
     "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{
    "-", "4.340278987621471093861393801514471297583`25.11429560638182*^20"}], 
    "-", 
    RowBox[{
    "9.70728290540708518002611530152190950372`24.46386688834523*^19", " ", 
     "\[ImaginaryI]"}]}], ",", 
   RowBox[{
   "3.2470568005289720716500709640844000527276`24.650410421188273*^21", "+", 
    RowBox[{
    "7.358452711251687484594830322327489882735`24.00569909048733*^20", " ", 
     "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{
    "-", "2.43363109788739183054373691548977465613111`24.186974340157718*^22"}\
], "-", 
    RowBox[{
    "5.5752369460354758137335380028690907645769`23.546975685260747*^21", " ", 
     "\[ImaginaryI]"}]}], ",", 
   RowBox[{
   "1.827091290540063890622933021167349078457168`23.72396292711702*^23", "+", 
    RowBox[{
    "4.22240971558888057339213785295964454526459`23.087756439028016*^22", " ",
      "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{
    "-", "1.3739142685106580972920011375374302762988457`23.26135383711323*^\
24"}], "-", 
    RowBox[{
    "3.196697037621439263620815198155042675083678`22.628089621885394*^23", 
     " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
   "1.03469103775732205536020238170108612842421689`22.79912658063614*^25", 
    "+", 
    RowBox[{
    "2.4193787464672326887881809368982136414261567`22.16801418538777*^24", 
     " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{
    "-", "7.80324330833508862478086770783009813377888086`22.33726232023485*^\
25"}], "-", 
    RowBox[{
    "1.83054074612412750338538248615084247276184374`21.70756144039402*^25", 
     " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
   "5.892752884378033265550462945302586684185376536`21.87574369433876*^26", 
    "+", 
    RowBox[{
    "1.38463605358473125318488983056189551613473259`21.246756360747945*^26", 
     " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{
    "-", "4.4556205330631992961628996554616733427257835731`21.414554664033304*^\
27"}], "-", 
    RowBox[{
    "1.0470719483685873508938754058677543480632401678`20.785618603165158*^27",
      " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
   "3.37299751548103642964630930156649909343238932874`20.95368037929243*^28", 
    "+", 
    RowBox[{
    "7.915949662739426623798871200916902707468279888`20.324163309118994*^27", 
     " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{
    "-", "2.556319138549993688999788671709804284312396353107`20.\
493107061774975*^29"}], "-", 
    RowBox[{
    "5.9829246612482987013546882319463923452972040293`19.862401737159686*^28",
      " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"1.939460112575545747115151070467`20.032821901780117*^30", "+", 
    RowBox[{
    "4.52068493962043206944365149739`19.400341761661647*^29", " ", 
     "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "1.4729594056073145073509151784584`19.572812967354864*^31"}],
     "-", 
    RowBox[{
    "3.414832212222301128462337835298`18.937988264951674*^30", " ", 
     "\[ImaginaryI]"}]}], ",", 
   RowBox[{"1.11975748833534079142712625535602`19.113069123869934*^32", "+", 
    RowBox[{
    "2.5787032935123731474248686202571`18.47534344310708*^31", " ", 
     "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "8.5204221235307532333540338359759`18.653579962646806*^32"}],
     "-", 
    RowBox[{
    "1.94666434632193441696789338095854`18.01240704073018*^32", " ", 
     "\[ImaginaryI]"}]}], ",", 
   RowBox[{"6.489096628896960547689481360992087`18.194335737437267*^33", "+", 
    RowBox[{
    "1.46902009644192251032156167245885`17.54917652622126*^33", " ", 
     "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{
    "-", "4.9462569887413398889220850002188905`17.735327307738334*^34"}], "-", 
    RowBox[{
    "1.108151475144176610237069980950828`17.085647216146793*^34", " ", 
     "\[ImaginaryI]"}]}], ",", 
   RowBox[{"3.77331332223534507290998953139539833`17.276546088076*^35", "+", 
    RowBox[{
    "8.3558672054506909496670394959156648`16.621812354989792*^34", " ", 
     "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{
    "-", "2.880768126477724415828196150786375291`16.817984002516685*^36"}], 
    "-", 
    RowBox[{
    "6.29781227267260492523113191824903017`16.157663154695832*^35", " ", 
     "\[ImaginaryI]"}]}], ",", 
   RowBox[{
   "2.2009967884274288625433379498771586205`16.35963344377101*^37", "+", 
    RowBox[{
    "4.744351855197479171192340053194598475`15.693188796858564*^36", " ", 
     "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{
    "-", "1.68284251677263753323398168944487869776`15.901487236342607*^38"}], 
    "-", 
    RowBox[{
    "3.5721908125380621584137785815491251911`15.228376399018298*^37", " ", 
     "\[ImaginaryI]"}]}], ",", 
   RowBox[{
   "1.287563279272650908691686126603242953484`15.443538603249662*^39", "+", 
    RowBox[{
    "2.68808394011471961802926788286305305622`14.763210945290632*^38", " ", 
     "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{
    "-", "9.857880030349905764271024350367813019392`14.985781135910058*^39"}],
     "-", 
    RowBox[{
    "2.021526198228230635132791376478144879`14.297675180327076*^39", " ", 
     "\[ImaginaryI]"}]}], ",", 
   RowBox[{
   "7.5522747028543557565059892246916910023907`14.528208766834815*^40", "+", 
    RowBox[{
    "1.5192183011312960126201649028784011854726`13.831749464364991*^40", " ", 
     "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{
    "-", "5.78950464153219137421142049665015427549357`14.070815744820116*^41"}\
], "-", 
    RowBox[{
    "1.14087711324169649169492146294704883756581`13.36541158578109*^41", " ", 
     "\[ImaginaryI]"}]}], ",", 
   RowBox[{
   "4.440839222088020370114623494417220494163968`13.613596612367871*^42", "+", 
    RowBox[{
    "8.560645308634578842828`12.898636526041566*^41", " ", 
     "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "3.408316103918348261474191`13.15654618509784*^43"}], "-", 
    RowBox[{
    "6.4178759109101243201712`12.431396170151237*^42", " ", 
     "\[ImaginaryI]"}]}], ",", 
   RowBox[{"2.6173240383605499364785716`12.699659532943636*^44", "+", 
    RowBox[{
    "4.806824966582433028688375`11.963658953526954*^43", " ", 
     "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "2.01099048389364925039482283`12.242931962949744*^45"}], "-", 
    RowBox[{
    "3.5964068317701436754220015`11.495389433507665*^44", " ", 
     "\[ImaginaryI]"}]}], ",", 
   RowBox[{"1.545930366356224085777608551`11.786359003508164*^46", "+", 
    RowBox[{
    "2.68769486207779666778395815`11.026547770262486*^45", " ", 
     "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "1.1890226069332820884212057697`11.329936389892255*^47"}], 
    "-", 
    RowBox[{
    "2.006060506788068594400424709`10.557089097393922*^46", " ", 
     "\[ImaginaryI]"}]}], ",", 
   RowBox[{"9.1496357503901227397369242123`10.873660050961243*^47", "+", 
    RowBox[{
    "1.4952288402722625892997265487`10.086962756671646*^47", " ", 
     "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "7.04408483372929689786792644692`10.417526096923382*^48"}], 
    "-", 
    RowBox[{
    "1.11278419294385136482072353615`9.61611136352925*^48", " ", 
     "\[ImaginaryI]"}]}], ",", 
   RowBox[{"5.425581737886897947283017797314`9.961530808058003*^49", "+", 
    RowBox[{
    "8.26772871419075693266942272634`9.144469659428742*^48", " ", 
     "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "4.1808364108271645500041565486717`9.505670624307399*^50"}], 
    "-", 
    RowBox[{
    "6.131357709407965824110019552868`8.671963092803322*^49", " ", 
     "\[ImaginaryI]"}]}], ",", 
   RowBox[{"3.22306906241133278111867611580301`9.049942135659176*^51", "+", 
    RowBox[{
    "4.5376865692806740067462891807506`8.19850605033023*^50", " ", 
     "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "2.485766418065053186505272956002075`8.59434207324814*^52"}],
     "-", 
    RowBox[{
    "3.35057083642847586114701529234811`7.723999632200007*^51", " ", 
     "\[ImaginaryI]"}]}], ",", 
   RowBox[{"1.9179188304612501058648124394281813`8.13886730111368*^53", "+", 
    RowBox[{
    "2.467701572260312471879693565798926`7.2483288248968245*^52", " ", 
     "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{
    "-", "1.4803843583602496345091591582156435`7.68351480855585*^54"}], "-", 
    RowBox[{
    "1.8122553937936015761990239427376785`6.7713588666056514*^53", " ", 
     "\[ImaginaryI]"}]}], ",", 
   RowBox[{
   "1.143111190210276746528680615423397432`7.228281703038503*^55", "+", 
    RowBox[{
    "1.32659424379577438926357520392390718`6.292930513807944*^54", " ", 
     "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "8.830143298702514`6.773165203593147*^55"}], "-", 
    RowBox[{
    "9.675137020623518`5.812853786650066*^54", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"6.82351360894542527`6.318162634681728*^56", "+", 
    RowBox[{
    "7.0266084675987665`5.330899567835296*^55", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "5.274791901926201778`5.8632714204806895*^57"}], "-", 
    RowBox[{
    "5.07835139728653541`4.846788107455777*^56", " ", "\[ImaginaryI]"}]}], 
   ",", 
   RowBox[{"4.0790182209284599075`5.408489079551851*^58", "+", 
    RowBox[{
    "3.649557649693675567`4.360172958785816*^57", " ", "\[ImaginaryI]"}]}], 
   ",", 
   RowBox[{
    RowBox[{"-", "3.15540601219290659295`4.9538132198694695*^59"}], "-", 
    RowBox[{
    "2.6053176692780065158`3.870617978055396*^58", " ", "\[ImaginaryI]"}]}], 
   ",", 
   RowBox[{"2.441746257115722328827`4.499241534174991*^60", "+", 
    RowBox[{
    "1.84511357462231133042`3.377563453976405*^59", " ", "\[ImaginaryI]"}]}], 
   ",", 
   RowBox[{
    RowBox[{"-", "1.8901140907682389233793`4.044771795634294*^61"}], "-", 
    RowBox[{
    "1.294170240472011983944`2.8802745545737545*^60", " ", 
     "\[ImaginaryI]"}]}], ",", 
   RowBox[{"1.46357295533440197851766`3.590401853773863*^62", "+", 
    RowBox[{
    "8.969595134776619879348`2.3777597104058326*^60", " ", 
     "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "1.133643187922811950737526`3.1361296306749313*^63"}], "-", 
    RowBox[{
    "6.1232561301037309437355`1.8686350869022885*^61", " ", 
     "\[ImaginaryI]"}]}], ",", 
   RowBox[{"8.783567484589676863066812`2.68195311740609*^63", "+", 
    RowBox[{
    "4.09830438774025499061131`1.3508858191202922*^62", " ", 
     "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "6.8076162810014160503043532`2.22787037067687*^64"}], "-", 
    RowBox[{
    "2.670162156818128184272028`0.8214123911198714*^63", " ", 
     "\[ImaginaryI]"}]}], ",", 
   RowBox[{"5.27771433881277145100720093`1.7738795096958495*^65", "+", 
    RowBox[{
    "1.6735744703913076450754732`0.275078142487897*^64", " ", 
     "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "4.093394564639039567087423786`1.3200417242719868*^66"}], 
    "+", 
    RowBox[{"0``-65.29204239641166", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"3.1745656196351884904534680405`0.8661339884994699*^67", "+", 
    RowBox[{"0``-66.6355508155413", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "2.4620042399`0.4121980018194965*^68"}], "+", 
    RowBox[{"0``-67.97909127427911", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0``-69.32266246025291", "+", 
    RowBox[{"0``-69.32266292463045", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0``-70.66626450186412", "+", 
    RowBox[{"0``-70.66626495169457", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0``-72.00989613606386", "+", 
    RowBox[{"0``-72.00989657197024", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0``-73.35355660919656", "+", 
    RowBox[{"0``-73.35355703176836", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0``-74.6972451959283", "+", 
    RowBox[{"0``-74.69724560572347", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0``-76.04096119784965", "+", 
    RowBox[{"0``-76.04096159539665", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0``-77.38470394216365", "+", 
    RowBox[{"0``-77.38470432796335", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0``-78.72847278045246", "+", 
    RowBox[{"0``-78.72847315497982", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0``-80.07226708751712", "+", 
    RowBox[{"0``-80.07226745122288", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0``-81.41608626028547", "+", 
    RowBox[{"0``-81.41608661359764", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0``-82.7599297167833", "+", 
    RowBox[{"0``-82.75993006010842", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0``-84.10379689516432", "+", 
    RowBox[{"0``-84.10379722888888", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0``-85.44768725279533", "+", 
    RowBox[{"0``-85.4476875772869", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0``-86.79160026539252", "+", 
    RowBox[{"0``-86.79160058100092", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0``-88.13553542620566", "+", 
    RowBox[{"0``-88.1355357332639", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0``-89.47949224524695", "+", 
    RowBox[{"0``-89.47949254407229", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0``-90.82347024856189", "+", 
    RowBox[{"0``-90.8234705394567", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0``-92.1674689775391", "+", 
    RowBox[{"0``-92.1674692607917", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0``-93.51148798825682", "+", 
    RowBox[{"0``-93.5114882641423", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0``-94.85552685086391", "+", 
    RowBox[{"0``-94.85552711964479", " ", "\[ImaginaryI]"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.8558188008383107`*^9, 3.855818869346813*^9, 
  3.8558247465241566`*^9},
 CellLabel->"Out[40]=",ExpressionUUID->"9ba16024-3898-4460-8b54-2c89013cdb36"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "Init\[Psi]out"}]], "Input",
 CellChangeTimes->{{3.8558188062452817`*^9, 3.855818808555924*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"0018b49d-2a86-442f-930c-cd8e7fbde421"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   FrameBox[
    DynamicModuleBox[{System`InformationDump`open$$ = True, 
     System`InformationDump`mouseOver$$ = False}, 
     PaneSelectorBox[{True->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False,
             BaseStyle -> None],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\"Global`Init\[Psi]out\"\>", "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          PaneBox[
           TagBox[GridBox[{
              {
               StyleBox[
                TagBox[
                 TooltipBox[
                  StyleBox["\<\" Definitions\"\>", "InformationRowLabel",
                   StripOnInput->False],
                  "\"Definitions\"",
                  TooltipStyle->"TextStyling"],
                 Annotation[#, "Definitions", "Tooltip"]& ], "DialogStyle",
                StripOnInput->False]},
              {
               TemplateBox[{"\"\[ThinSpace]\"", 
                 GridBox[{{
                    RowBox[{
                    RowBox[{"Init\[Psi]out", "[", 
                    
                    RowBox[{
                    "l_", ",", "m_", ",", "kout_", ",", "a_", ",", "M_", ",", 
                    "\[Omega]i_"}], "]"}], ":=", 
                    RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"i", "=", "l"}], ",", 
                    RowBox[{"j", "=", "m"}], ",", 
                    RowBox[{"N", "=", "kout"}], ",", 
                    RowBox[{"s", "=", "a"}], ",", 
                    RowBox[{"\[CapitalMu]", "=", "M"}], ",", "f0", ",", "f1", 
                    ",", "f2", ",", "f3", ",", "f4", ",", "f5", ",", "f6", 
                    ",", "n", ",", 
                    RowBox[{"\[Omega]", "=", "\[Omega]i"}], ",", 
                    "\[Lambda]"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"\[Lambda]", "=", 
                    RowBox[{
                    RowBox[{"SpinWeightedSpheroidalEigenvalue", "[", 
                    RowBox[{"0", ",", "i", ",", "j", ",", 
                    RowBox[{"s", " ", "\[Omega]"}]}], "]"}], "-", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"s", " ", "\[Omega]"}], ")"}], "2"], "+", 
                    RowBox[{"2", " ", "j", " ", "s", " ", "\[Omega]"}]}]}], 
                    ";", 
                    RowBox[{"f0", "=", 
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", "n", " ", 
                    "\[Omega]"}]}], ";", 
                    RowBox[{"f1", "=", 
                    RowBox[{
                    SuperscriptBox["n", "2"], "-", "\[Lambda]", "+", 
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "4"}], " ", "\[ImaginaryI]", " ", 
                    "\[CapitalMu]"}], "+", 
                    RowBox[{
                    SuperscriptBox["s", "2"], " ", "\[Omega]"}]}], ")"}]}], 
                    "+", 
                    RowBox[{"n", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    
                    RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[CapitalMu]", 
                    " ", "\[Omega]"}]}], ")"}]}]}]}], ";", 
                    RowBox[{"f2", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
                    SuperscriptBox["s", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "\[Omega]"}], 
                    "+", 
                    RowBox[{"2", " ", "\[CapitalMu]", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "3"}], "+", 
                    RowBox[{"5", " ", "n"}], "-", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["n", "2"]}], "+", "\[Lambda]", "-", 
                    RowBox[{"2", " ", "s", " ", "j", " ", "\[Omega]"}], "+", 
                    RowBox[{
                    SuperscriptBox["s", "2"], " ", 
                    SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}]}]}], ";", 
                    RowBox[{"f3", "=", 
                    RowBox[{
                    RowBox[{"4", " ", 
                    SuperscriptBox["\[CapitalMu]", "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", "n"}], ")"}], "2"]}], "+", 
                    RowBox[{
                    SuperscriptBox["s", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"8", "+", 
                    SuperscriptBox["j", "2"], "-", 
                    RowBox[{"8", " ", "n"}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["n", "2"]}], "-", "\[Lambda]"}], 
                    ")"}]}]}]}], ";", 
                    RowBox[{"f4", "=", 
                    RowBox[{
                    RowBox[{"-", "2"}], " ", 
                    SuperscriptBox["a", "2"], " ", "\[CapitalMu]", " ", 
                    RowBox[{"(", 
                    RowBox[{"15", "-", 
                    RowBox[{"11", " ", "n"}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["n", "2"]}]}], ")"}]}]}], ";", 
                    RowBox[{"f5", "=", 
                    RowBox[{
                    SuperscriptBox["s", "4"], " ", 
                    RowBox[{"(", 
                    RowBox[{"12", "-", 
                    RowBox[{"7", " ", "n"}], "+", 
                    SuperscriptBox["n", "2"]}], ")"}]}]}], ";", 
                    RowBox[{"cs", "=", 
                    RowBox[{"RecurrenceTable", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"f0", " ", 
                    RowBox[{"c", "[", "n", "]"}]}], "+", 
                    RowBox[{"f1", " ", 
                    RowBox[{"c", "[", 
                    RowBox[{"n", "-", "1"}], "]"}]}], "+", 
                    RowBox[{"f2", " ", 
                    RowBox[{"c", "[", 
                    RowBox[{"n", "-", "2"}], "]"}]}], "+", 
                    RowBox[{"f3", " ", 
                    RowBox[{"c", "[", 
                    RowBox[{"n", "-", "3"}], "]"}]}], "+", 
                    RowBox[{"f4", " ", 
                    RowBox[{"c", "[", 
                    RowBox[{"n", "-", "4"}], "]"}]}], "+", 
                    RowBox[{"f5", " ", 
                    RowBox[{"c", "[", 
                    RowBox[{"n", "-", "5"}], "]"}]}]}], "\[Equal]", "0"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"c", "[", "0", "]"}], "\[Equal]", "1"}], ",", 
                    RowBox[{
                    RowBox[{"c", "[", 
                    RowBox[{"-", "1"}], "]"}], "\[Equal]", "0"}], ",", 
                    RowBox[{
                    RowBox[{"c", "[", 
                    RowBox[{"-", "2"}], "]"}], "\[Equal]", "0"}], ",", 
                    RowBox[{
                    RowBox[{"c", "[", 
                    RowBox[{"-", "3"}], "]"}], "\[Equal]", "0"}], ",", 
                    RowBox[{
                    RowBox[{"c", "[", 
                    RowBox[{"-", "4"}], "]"}], "\[Equal]", "0"}]}], "}"}], 
                    ",", "c", ",", 
                    RowBox[{"{", 
                    RowBox[{"n", ",", "0", ",", "N"}], "}"}]}], "]"}]}]}]}], 
                    "]"}]}]}, {" "}}, 
                  GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                  DefaultBaseStyle -> "Column", 
                  GridBoxItemSize -> {
                   "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}]},
                "RowDefault"]}
             },
             DefaultBaseStyle->"Column",
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Column"],
           FrameMargins->{{6, 0}, {3, 6}}], "\<\"\"\>"},
         {
          PaneBox[GridBox[{
             {
              
              DynamicModuleBox[{System`InformationDump`open$$ = {
               False, False, False, False, False, False}}, 
               StyleBox[GridBox[{
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Full Name\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"FullName\"",
                    TooltipStyle->"TextStyling"],
                    
                    Annotation[#, "FullName", 
                    "Tooltip"]& ], "\<\"Global`Init\[Psi]out\"\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {Right, Left}},
                 GridBoxDividers->None,
                 GridBoxItemSize->{"Columns" -> {Automatic, Automatic}},
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.5599999999999999]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.8]}, 
                    Offset[0.2]}}], "DialogStyle",
                StripOnInput->False],
               DynamicModuleValues:>{}]}
            },
            DefaultBaseStyle->"Column",
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.5599999999999999]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[3.6]}, 
                Offset[0.2]}}],
           FrameMargins->{{6, 6}, {6, 3}}], ""},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpener"],
               ImageSizeCache->{11., {4., 7.}}], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpenerHot"],
               ImageSizeCache->{11., {4., 7.}}]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, False],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], False->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\"Global`Init\[Psi]out\"\>", "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpener"]], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpenerHot"]]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, True],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"]}, Dynamic[System`InformationDump`open$$],
      BaselinePosition->Baseline,
      FrameMargins->0,
      ImageSize->Automatic],
     DynamicModuleValues:>{}],
    BaseStyle->"InformationGridFrame",
    StripOnInput->False], "InformationGridPlain",
   StripOnInput->False],
  InformationData[
   Association[
   "ObjectType" -> "Symbol", "Usage" -> "Global`Init\[Psi]out", 
    "Documentation" -> None, "OwnValues" -> None, "UpValues" -> None, 
    "DownValues" -> 
    Information`InformationValueForm[
     DownValues, $CellContext`Init\[Psi]out, {$CellContext`Init\[Psi]out[
         Pattern[$CellContext`l, 
          Blank[]], 
         Pattern[$CellContext`m, 
          Blank[]], 
         Pattern[$CellContext`kout, 
          Blank[]], 
         Pattern[$CellContext`a, 
          Blank[]], 
         Pattern[$CellContext`M, 
          Blank[]], 
         Pattern[$CellContext`\[Omega]i, 
          Blank[]]] :> 
       Module[{$CellContext`i = $CellContext`l, $CellContext`j = \
$CellContext`m, 
          N = $CellContext`kout, $CellContext`s = $CellContext`a, \
$CellContext`\[CapitalMu] = $CellContext`M, $CellContext`f0, $CellContext`f1, \
$CellContext`f2, $CellContext`f3, $CellContext`f4, $CellContext`f5, \
$CellContext`f6, $CellContext`n, $CellContext`\[Omega] = \
$CellContext`\[Omega]i, $CellContext`\[Lambda]}, $CellContext`\[Lambda] = 
          SpinWeightedSpheroidalHarmonics`SpinWeightedSpheroidalEigenvalue[
            0, $CellContext`i, $CellContext`j, $CellContext`s $CellContext`\
\[Omega]] - ($CellContext`s $CellContext`\[Omega])^2 + 
           2 $CellContext`j $CellContext`s $CellContext`\[Omega]; \
$CellContext`f0 = (-2) 
           I $CellContext`n $CellContext`\[Omega]; $CellContext`f1 = \
$CellContext`n^2 - $CellContext`\[Lambda] + $CellContext`\[Omega] ((-4) 
              I $CellContext`\[CapitalMu] + $CellContext`s^2 $CellContext`\
\[Omega]) + $CellContext`n (-1 + 
             4 I $CellContext`\[CapitalMu] $CellContext`\[Omega]); \
$CellContext`f2 = (-2) 
            I $CellContext`s^2 (-2 + $CellContext`n) $CellContext`\[Omega] + 
           2 $CellContext`\[CapitalMu] (-3 + 5 $CellContext`n - 
             2 $CellContext`n^2 + $CellContext`\[Lambda] - 
             2 $CellContext`s $CellContext`j $CellContext`\[Omega] + \
$CellContext`s^2 $CellContext`\[Omega]^2); $CellContext`f3 = 
          4 $CellContext`\[CapitalMu]^2 (-2 + $CellContext`n)^2 + \
$CellContext`s^2 (8 + $CellContext`j^2 - 8 $CellContext`n + 
             2 $CellContext`n^2 - $CellContext`\[Lambda]); $CellContext`f4 = \
(-2) $CellContext`a^2 $CellContext`\[CapitalMu] (15 - 11 $CellContext`n + 
            2 $CellContext`n^2); $CellContext`f5 = $CellContext`s^4 (12 - 
            7 $CellContext`n + $CellContext`n^2); $CellContext`cs = 
          RecurrenceTable[{$CellContext`f0 $CellContext`c[$CellContext`n] + \
$CellContext`f1 $CellContext`c[$CellContext`n - 
                 1] + $CellContext`f2 $CellContext`c[$CellContext`n - 
                 2] + $CellContext`f3 $CellContext`c[$CellContext`n - 
                 3] + $CellContext`f4 $CellContext`c[$CellContext`n - 
                 4] + $CellContext`f5 $CellContext`c[$CellContext`n - 5] == 
             0, $CellContext`c[0] == 1, $CellContext`c[-1] == 
             0, $CellContext`c[-2] == 0, $CellContext`c[-3] == 
             0, $CellContext`c[-4] == 0}, $CellContext`c, {$CellContext`n, 0, 
             N}]]}], "SubValues" -> None, "DefaultValues" -> None, "NValues" -> 
    None, "FormatValues" -> None, "Options" -> None, "Attributes" -> {}, 
    "FullName" -> "Global`Init\[Psi]out"], False]]], "Output",
 CellChangeTimes->{3.855818808942742*^9},
 CellLabel->"Out[32]=",ExpressionUUID->"9d8dcf3b-15d2-41fd-9f67-4eb16e7ecb73"]
}, Open  ]]
},
WindowSize->{718.5, 747.},
WindowMargins->{{-5.25, Automatic}, {Automatic, 0}},
Magnification:>1.1 Inherited,
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"07e88d57-f0a4-4909-987b-466deac22d3d"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 215, 3, 52, "Input",ExpressionUUID->"fa6c7144-3c9c-436e-9792-8bc2b212b88b"],
Cell[776, 25, 2607, 65, 170, "Input",ExpressionUUID->"99355c76-e0e6-48e9-954f-40c0e8a73720"],
Cell[3386, 92, 4174, 130, 219, "Input",ExpressionUUID->"bcd23571-9956-47cb-b202-9ee0ed9587d5"],
Cell[7563, 224, 5850, 130, 670, "Input",ExpressionUUID->"373c5412-f293-445b-afa3-6e5082761baf"],
Cell[CellGroupData[{
Cell[13438, 358, 351, 6, 31, "Input",ExpressionUUID->"3c677efe-45bc-4945-bc89-c2cf7a727785"],
Cell[13792, 366, 267, 3, 35, "Output",ExpressionUUID->"eb4e9bdf-fe59-4005-98c6-2a7fff3d5ee7"]
}, Open  ]],
Cell[14074, 372, 610, 18, 53, "Input",ExpressionUUID->"1bbee7e6-50c9-4954-93b5-1c92ba244dac"],
Cell[14687, 392, 7118, 198, 473, "Input",ExpressionUUID->"0c98fdac-34c6-4d25-a777-31bbf17cd76d"],
Cell[21808, 592, 19911, 520, 981, "Input",ExpressionUUID->"549b09d1-4ac0-447f-bc15-a03348489d69"],
Cell[41722, 1114, 2759, 90, 225, "Input",ExpressionUUID->"4d6101ea-3549-494e-a4e1-7d343e25ed00"],
Cell[44484, 1206, 15025, 360, 1754, "Input",ExpressionUUID->"f3b4779e-959c-42ce-b1cf-63a34ac7859a"],
Cell[CellGroupData[{
Cell[59534, 1570, 1685, 34, 220, "Input",ExpressionUUID->"e48b7ed5-a380-4c4d-8063-9b2f0231704f"],
Cell[61222, 1606, 546, 8, 35, "Output",ExpressionUUID->"7877ab1f-ebbb-45a1-a5d5-21b1eaf2feb5"],
Cell[61771, 1616, 526, 7, 35, "Output",ExpressionUUID->"aae1d080-a1d4-4747-a591-bb0995a308b0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62334, 1628, 413, 8, 31, "Input",ExpressionUUID->"ba643993-5f42-4284-b76f-3922c5c59a17"],
Cell[62750, 1638, 464, 10, 35, "Output",ExpressionUUID->"d3ada9c9-efeb-4a23-ac7e-e77862eb4328"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63251, 1653, 830, 22, 94, "Input",ExpressionUUID->"630b6e9f-4422-4e35-8aab-8d7afcd6eddc"],
Cell[64084, 1677, 182, 2, 35, "Output",ExpressionUUID->"f30afe8d-a4d3-4114-a3de-167b1daee7d5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[64303, 1684, 343, 6, 31, "Input",ExpressionUUID->"e772c0ca-dcaf-4c25-bf42-128d21ac5902"],
Cell[64649, 1692, 235, 4, 35, "Output",ExpressionUUID->"aaba5955-0357-407b-bdeb-63eb54bbd940"]
}, Open  ]],
Cell[64899, 1699, 1083, 29, 118, "Input",ExpressionUUID->"9efff70a-491e-4c24-acc1-92a1bf64f8e4"],
Cell[65985, 1730, 2853, 77, 190, "Input",ExpressionUUID->"97cbc5bd-003d-495c-8920-4d4b0ad5b8ca"],
Cell[CellGroupData[{
Cell[68863, 1811, 452, 8, 31, "Input",ExpressionUUID->"834f52af-76e1-4bd9-99cc-3a351491ca50"],
Cell[69318, 1821, 19576, 487, 1898, "Output",ExpressionUUID->"9ba16024-3898-4460-8b54-2c89013cdb36"]
}, Open  ]],
Cell[CellGroupData[{
Cell[88931, 2313, 203, 3, 31, "Input",ExpressionUUID->"0018b49d-2a86-442f-930c-cd8e7fbde421"],
Cell[89137, 2318, 19028, 436, 501, "Output",ExpressionUUID->"9d8dcf3b-15d2-41fd-9f67-4eb16e7ecb73"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

